<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Never Give Up</title>
</head>

<body onload="nome_usuario()" class="conteudo_total">

    <div id="cabecalho" class="header">
        <div class="container">
            <img src="img/LOGO.png" alt="Logo da Never Give Up">
            <ul>
                <li class="current_page"> <a>Fórum</a> </li>
                <li class="current_page"> <a id="nome_usuario_a"> Nome usuario </a> </li>
                <!--
                <li> <a href="index.html">HOME</a> </li>
                <li> <a href="sobre.html">SOBRE</a> </li>
                <li> <a href="cadastro.html">CADASTRO</a> </li>
                <li> <a href="login.html">LOGIN</a> </li>
                -->
            </ul>
        </div>
    </div>

    <div class="div_estado_emocional" id="div_estado_emocional">
        <h1>Conte-nos como você está se sentindo?</h1>
        <div class="container_estado_emocional">
            <form method="POST" id="form_estado_emocional" onsubmit="return inserir_estado_emocional()">
                <div class="box_happy">
                    <input type="radio" name="estado_emocional" value="usuario_feliz">
                    <img src="./img/emoji_feliz.png" alt="emoji_feliz">
                </div>
                <div class="box_normal">
                    <input type="radio" name="estado_emocional" value="usuario_normal">
                    <img src="./img/emoji_normal.png" alt="emoji_normal">
                </div>
                <div class="box_sad">
                    <input type="radio" name="estado_emocional" value="usuario_sad">
                    <img src="./img/emoji_triste.png" alt="emoji_triste">
                </div>

                <input class="btn_emocional" type="submit" id="id_btn_estado_emocional">

            </form>
        </div>
    </div>

    <div class="div_englobando_personagens">
        <div class="div_nome_personagens" id="div_nome_personagens">
            <h1>Nome de personagens do anime Naruto que você mais gosta: </h1>
            <textarea maxlength="20" placeholder="Digite aqui" name="" id="textarea_personagens" cols="30"
                rows="3"></textarea>
            <br>
            <button onclick="adicionar_personagem()">Adicionar personagem</button> <button
                onclick="limpar_div_personagens()">limpar personagens</button>
            <div id="div_mostrar_personagens">

            </div>
        </div>

        <div id="div_foto_personagens" class="div_foto_personagens">

        </div>
    </div>

    <div id="div_auto_conhecimento" class="div_auto_conhecimento">

        <h1>Como você reage a estes estados emocionais?</h1>

        <form method="POST" id="form_auto_conhecimento" onsubmit="return inserir()">

            <span>Timidez</span> <input autocomplete="off" maxlength="150" type="text" name="timidez" id="idTimidez">

            <span>Oratoria</span> <input autocomplete="off" maxlength="150" type="text" name="oratoria" id="idOratoria">

            <p class="span_quebra_expectativa">Quebra de expectativa</p> <input autocomplete="off" maxlength="150"
                type="text" name="quebraDeExpectativa" id="idQuebraDeExpectativa">

            <span>Solidao</span><input autocomplete="off" maxlength="150" type="text" name="solidao" id="idSolidao">

            <span>Saudade</span><input autocomplete="off" maxlength="150" type="text" name="saudade" id="idSaudade">

            <span>Felicidade</span><input autocomplete="off" maxlength="150" type="text" name="felicidade"
                id="idFelicidade">

            <span>Conquista</span><input autocomplete="off" maxlength="150" type="text" name="conquista"
                id="idConquista">

            <!--<input type="submit" value="inserir">Inserir dados</button>-->

            <!--<input type="submit" value="inserir">-->

            <button style="display: none;" type="submit">Enviar</button>

        </form>

        <button onclick="verificar_dados_autoconhecimento()">Enviar</button>

        <button onclick="obterPublicacoesPorUsuario()">Ver publicacoes</button>

        <div id="div_erro" style="background-color: sandybrown; color: maroon; display: none;">
            Erro ao inserir dados
        </div>

    </div>

    <div id="div_mostrar_conteudo">

        <div id="div_nome_usuario_autoconhecimento">
            <h2> Usuario: </h2>
        </div>
        <div id="div_timidez_usuario_autoconhecimento">
            <h2> Timidez: </h2>
        </div>
        <div id="div_oratoria_usuario_autoconhecimento">
            <h2> Oratoria: </h2>
        </div>
        <div id="div_quebraDeExpectativa_usuario_autoconhecimento">
            <h2> Quebra de Expectativa: </h2>
        </div>
        <div id="div_solidao_usuario_autoconhecimento">
            <h2> Solidao: </h2>
        </div>
        <div id="div_saudade_usuario_autoconhecimento">
            <h2> Saudade: </h2>
        </div>
        <div id="div_felicidade_usuario_autoconhecimento">
            <h2> Felicidade: </h2>
        </div>
        <div id="div_conquista_usuario_autoconhecimento">
            <h2> Conquista: </h2>
        </div>

    </div>

    <div id="div_pessoa_melhor" class="div_pessoa_melhor">

        <h1>Como você acha que deveria reagir a estes estados emocionais para se tornar uma pessoa melhor?</h1>

        <form method="POST" id="form_pessoa_melhor" onsubmit="return inserirPessoaMelhor()">

            <span>Timidez</span><input autocomplete="off" maxlength="150" type="text" name="timidez" id="idTimidez2">

            <span>Oratoria</span> <input autocomplete="off" maxlength="150" type="text" name="oratoria"
                id="idOratoria2">

            <p>Quebra de expectativa</p><input autocomplete="off" maxlength="150" type="text" name="quebraDeExpectativa"
                id="idQuebraDeExpectativa2">

            <span>Solidao</span><input autocomplete="off" maxlength="150" type="text" name="solidao" id="idSolidao2">

            <span>Saudade</span><input autocomplete="off" maxlength="150" type="text" name="saudade" id="idSaudade2">

            <span>Felicidade</span><input autocomplete="off" maxlength="150" type="text" name="felicidade"
                id="idFelicidade2">

            <span>Conquista</span><input autocomplete="off" maxlength="150" type="text" name="conquista"
                id="idConquista2">

            <!--<input type="submit" value="inserir">Inserir dados</button>-->

            <!--<input type="submit" value="inserirPessoaMelhor">-->

            <button style="display:none;" type="submit">Enviar</button>

        </form>

        <button onclick="verificar_dados_pessoamelhor()">Enviar</button>
    </div>

    <!-- <button onclick="obterPublicacoesPorUsuario()">CLIQUE AQUI</button>

    <div id="div_mostrar_auto_conhecimento">
        <h1>quero mostrar aqui</h1>
    </div> 
-->

    <div id="div_opiniao_usuario" class="div_opiniao_usuario">
        <div class="div_opiniao_usuario_container">
            <h1> Nos dê a sua opinião logo abaixo sobre o site com uma nota de (0 a 5) ↓ </h1>

            <div class="div_select_nota">
                <h3>Escolha a nota aqui:</h3>

                <form method="POST" id="form_opiniao_usuario" onsubmit="return inserir_opiniao_usuario()">
                    <select name="name_select_opiniao_usuario" id="id_select_opiniao_usuario">
                        <option value="0">Nota 0</option>
                        <option value="1">Nota 1</option>
                        <option value="2">Nota 2</option>
                        <option value="3">Nota 3</option>
                        <option value="4">Nota 4</option>
                        <option value="5">Nota 5</option>
                    </select>
                    <br>
                    <button type="submit">Enviar nota</button>
                </form>

            </div>

        </div>
    </div>

    <div id="div_congratulations" class="div_congratulations">
        <div class="div_congratulations_container">
            <h1>Parabéns e muito obrigado por fazer parte da família que nunca desiste!</h1>

            <img src="https://i.pinimg.com/originals/db/e8/ae/dbe8ae9521e5f9bab72d0aea3e9c6739.jpg"
                alt="Imagem do Naruto feliz">

            <span>

            </span>

        </div>
    </div>


</body>

</html>

<script>

    function obterPublicacoesPorUsuario() {
        var idUsuario = sessionStorage.id_usuario_meuapp;

        fetch(`/usuarios/${idUsuario}`)
            .then(resposta => {
                if (resposta.ok) {
                    resposta.json().then(function (resposta) {
                        console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);

                        //div_mostrar_conteudo.innerHTML = `<h1> Timidez: </h1>${resposta[0].timidez}`;
                        div_auto_conhecimento.style.display = "none";
                        div_mostrar_conteudo.style.display = "block";
                        div_nome_usuario_autoconhecimento.innerHTML += resposta[0].nome;
                        div_timidez_usuario_autoconhecimento.innerHTML += resposta[0].timidez;
                        div_oratoria_usuario_autoconhecimento.innerHTML += resposta[0].oratoria;
                        div_quebraDeExpectativa_usuario_autoconhecimento.innerHTML += resposta[0].QuebraDeExpectativa;
                        div_solidao_usuario_autoconhecimento.innerHTML += resposta[0].solidao;
                        div_saudade_usuario_autoconhecimento.innerHTML += resposta[0].saudade;
                        div_felicidade_usuario_autoconhecimento.innerHTML += resposta[0].felicidade;
                        div_conquista_usuario_autoconhecimento.innerHTML += resposta[0].conquista;
                        //console.log(resposta[0].timidez);

                    });
                } else {
                    console.error('Nenhum dado encontrado ou erro na API');
                }
            })
            .catch(function (error) {
                console.error(`Erro na obtenção das publicações do usuário: ${error.message}`);
            });
    }

    function nome_usuario() { // buscando nome de usuario na session storage de login
        var nomeUsuario = sessionStorage.nome_usuario_meuapp;
        nome_usuario_a.innerHTML = nomeUsuario;
    }

    function limpar_div_personagens() {
        numero = 0;
        lista_personagens = [];
        div_mostrar_personagens.innerHTML = "";
        div_foto_personagens.innerHTML = "";
    }

    var lista_personagens = [];
    function adicionar_personagem() {
        let personagem = textarea_personagens.value;
        var numero = 1;

        if (personagem == "") {
            alert("Digite um nome válido.");
        }

        else if (lista_personagens.length > 2) {
            alert("Voce só pode adicionar 3 personagens!");
        }

        else if (personagem.toLowerCase() == "naruto") {
            lista_personagens.push(personagem);
            div_foto_personagens.innerHTML +=
                ` <img style = "width: 300px; margin: 10px;" src="https://i.pinimg.com/736x/a9/4b/10/a94b105911007f7262c52b242766a58a.jpg" 
            alt="imagem do naruto"> `;
            div_mostrar_personagens.innerHTML += `  ${personagem.toUpperCase()} <br>  `;
            numero++;
        }
        else if (personagem.toLowerCase() == "sasuke") {
            lista_personagens.push(personagem);
            div_foto_personagens.innerHTML +=
                ` <img style = "width: 302px; margin: 10px;" src="https://i.pinimg.com/originals/f5/a2/35/f5a235ed524781a7f837361a0970f16d.jpg" 
            alt="imagem do sasuke"> `;
            div_mostrar_personagens.innerHTML += `  ${personagem.toUpperCase()} <br>  `;
            numero++;
        }

        else {
            lista_personagens.push(personagem);
            div_mostrar_personagens.innerHTML = "";
            for (var contador = 0; contador < lista_personagens.length; contador++) {
                div_mostrar_personagens.innerHTML += ` ${lista_personagens[contador].toUpperCase()} <br>  `;
                numero++;
            }
        }

        textarea_personagens.value = "";
    }


    function inserir_opiniao_usuario() {
        // aguardar();
        var formulario = new URLSearchParams(new FormData(form_opiniao_usuario));
        var idUsuario = sessionStorage.id_usuario_meuapp;
        fetch(`/usuarios/inserir_opiniao_usuario/${idUsuario}`, {
            method: "POST",
            body: formulario
        }).then(function (response) {
            if (response.ok) {

                alert("Sua nota foi enviada com sucesso, agradecemos pela sua opinião!");
                div_opiniao_usuario.style.display = "none";
                div_congratulations.style.display = "block";

                // window.location.href = 'login.html';


            } else {

                console.log('Erro ao inserir dados na tbl opiniao_usuario!');
                response.text().then(function (resposta) {
                    div_erro.innerHTML = resposta;
                });
                // finalizar_aguardar();
            }
        });

        return false;
    }

    function verificar_dados_autoconhecimento() {
        let in_timidez = idTimidez.value;
        let in_oratoria = idOratoria.value;
        let in_quebra_expectativa = idQuebraDeExpectativa;
        let in_solidao = idSolidao.value;
        let in_saudade = idSaudade.value;
        let in_felicidade = idFelicidade.value;
        let in_conquista = idConquista.value;

        if (in_timidez == "") {
            alert("Digite um campo válido!");
        }
        else if (in_oratoria == "") {
            alert("Digite um campo válido!");
        }
        else if (in_quebra_expectativa == "") {
            alert("Digite um campo válido!");
        }
        else if (in_solidao == "") {
            alert("Digite um campo válido!");
        }
        else if (in_saudade == "") {
            alert("Digite um campo válido!");
        }
        else if (in_felicidade == "") {
            alert("Digite um campo válido!");
        }
        else if (in_conquista == "") {
            alert("Digite um campo válido!");
        }
        else {
            inserir();
        }
    }

    function inserir() {
        // aguardar();
        var formulario = new URLSearchParams(new FormData(form_auto_conhecimento));
        var idUsuario = sessionStorage.id_usuario_meuapp;
        fetch(`/usuarios/inserir/${idUsuario}`, {
            method: "POST",
            body: formulario
        }).then(function (response) {

            if (response.ok) {

                alert("Dados enviados para o servidor da NeverGiveUp com sucesso!");
                div_auto_conhecimento.style.display = "none";

                // window.location.href = 'login.html';


            } else {

                console.log('Erro ao inserir dados na tbl autoconhecimento!');
                response.text().then(function (resposta) {
                    div_erro.innerHTML = resposta;
                });
                // finalizar_aguardar();
            }

        });

        return false;
    }

    function verificar_dados_pessoamelhor() {
        let in_timidez = idTimidez2.value;
        let in_oratoria = idOratoria2.value;
        let in_quebra_expectativa = idQuebraDeExpectativa2;
        let in_solidao = idSolidao2.value;
        let in_saudade = idSaudade2.value;
        let in_felicidade = idFelicidade2.value;
        let in_conquista = idConquista2.value;

        if (in_timidez == "") {
            alert("Digite um campo válido!");
        }
        else if (in_oratoria == "") {
            alert("Digite um campo válido!");
        }
        else if (in_quebra_expectativa == "") {
            alert("Digite um campo válido!");
        }
        else if (in_solidao == "") {
            alert("Digite um campo válido!");
        }
        else if (in_saudade == "") {
            alert("Digite um campo válido!");
        }
        else if (in_felicidade == "") {
            alert("Digite um campo válido!");
        }
        else if (in_conquista == "") {
            alert("Digite um campo válido!");
        }
        else {
            inserirPessoaMelhor();
        }
    }

    function inserirPessoaMelhor() {
        // aguardar();
        var formulario = new URLSearchParams(new FormData(form_pessoa_melhor));
        var idUsuario = sessionStorage.id_usuario_meuapp;
        fetch(`/usuarios/inserirPessoaMelhor/${idUsuario}`, {
            method: "POST",
            body: formulario
        }).then(function (response) {

            if (response.ok) {

                alert("Dados enviados para o servidor da NeverGiveUp com sucesso!");
                div_pessoa_melhor.style.display = "none";
                // window.location.href = 'login.html';


            } else {

                console.log('Erro ao inserir dados na tbl PessoaMelhor!');
                response.text().then(function (resposta) {
                    div_erro.innerHTML = resposta;
                });
                // finalizar_aguardar();
            }

        });

        return false;
    }


    function inserir_estado_emocional() {
        // aguardar();
        var formulario = new URLSearchParams(new FormData(form_estado_emocional));
        var idUsuario = sessionStorage.id_usuario_meuapp;
        fetch(`/usuarios/inserir_estado_emocional/${idUsuario}`, {
            method: "POST",
            body: formulario
        }).then(function (response) {



            if (response.ok) {

                alert("Dados enviados com sucesso! Agradecemos pelo envio da informação.");


                div_estado_emocional.style.display = "none";
                div_nome_personagens.style.marginTop = "100px";

                // window.location.href = 'login.html';


            } else {

                console.log('Erro ao inserir dados na tbl estado_emocional!');
                response.text().then(function (resposta) {
                    // div_erro.innerHTML = resposta;
                });
                // finalizar_aguardar();
            }


        });

        return false;
    }

</script>